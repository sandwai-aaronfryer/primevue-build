"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=require("primevue/utils"),l=require("primevue/api"),i=e(require("primevue/ripple")),o=e(require("primevue/virtualscroller")),n=require("vue"),s={name:"Listbox",emits:["update:modelValue","change","filter"],props:{modelValue:null,options:Array,optionLabel:null,optionValue:null,optionDisabled:null,optionGroupLabel:null,optionGroupChildren:null,listStyle:null,disabled:Boolean,dataKey:null,multiple:Boolean,metaKeySelection:Boolean,filter:Boolean,filterPlaceholder:String,filterLocale:String,filterMatchMode:{type:String,default:"contains"},filterFields:{type:Array,default:null},emptyFilterMessage:{type:String,default:null},emptyMessage:{type:String,default:null},virtualScrollerOptions:{type:Object,default:null}},optionTouched:!1,virtualScroller:null,data:()=>({filterValue:null}),methods:{getOptionIndex(e,t){return this.virtualScrollerDisabled?e:t&&t(e).index},getOptionLabel(e){return this.optionLabel?t.ObjectUtils.resolveFieldData(e,this.optionLabel):e},getOptionValue(e){return this.optionValue?t.ObjectUtils.resolveFieldData(e,this.optionValue):e},getOptionRenderKey(e){return this.dataKey?t.ObjectUtils.resolveFieldData(e,this.dataKey):this.getOptionLabel(e)},isOptionDisabled(e){return!!this.optionDisabled&&t.ObjectUtils.resolveFieldData(e,this.optionDisabled)},getOptionGroupRenderKey(e){return t.ObjectUtils.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupLabel(e){return t.ObjectUtils.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupChildren(e){return t.ObjectUtils.resolveFieldData(e,this.optionGroupChildren)},onOptionSelect(e,t){this.disabled||this.isOptionDisabled(t)||(this.multiple?this.onOptionSelectMultiple(e,t):this.onOptionSelectSingle(e,t),this.optionTouched=!1)},onOptionTouchEnd(){this.disabled||(this.optionTouched=!0)},onOptionSelectSingle(e,t){let l=this.isSelected(t),i=!1,o=null;if(!this.optionTouched&&this.metaKeySelection){let n=e.metaKey||e.ctrlKey;l?n&&(o=null,i=!0):(o=this.getOptionValue(t),i=!0)}else o=l?null:this.getOptionValue(t),i=!0;i&&this.updateModel(e,o)},onOptionSelectMultiple(e,t){let l=this.isSelected(t),i=!1,o=null;if(!this.optionTouched&&this.metaKeySelection){let n=e.metaKey||e.ctrlKey;l?(o=n?this.removeOption(t):[this.getOptionValue(t)],i=!0):(o=n&&this.modelValue||[],o=[...o,this.getOptionValue(t)],i=!0)}else o=l?this.removeOption(t):[...this.modelValue||[],this.getOptionValue(t)],i=!0;i&&this.updateModel(e,o)},isSelected(e){let l=!1,i=this.getOptionValue(e);if(this.multiple){if(this.modelValue)for(let e of this.modelValue)if(t.ObjectUtils.equals(e,i,this.equalityKey)){l=!0;break}}else l=t.ObjectUtils.equals(this.modelValue,i,this.equalityKey);return l},removeOption(e){return this.modelValue.filter((l=>!t.ObjectUtils.equals(l,this.getOptionValue(e),this.equalityKey)))},updateModel(e,t){this.$emit("update:modelValue",t),this.$emit("change",{originalEvent:e,value:t})},onOptionKeyDown(e,t){let l=e.currentTarget;switch(e.which){case 40:var i=this.findNextItem(l);i&&i.focus(),e.preventDefault();break;case 38:var o=this.findPrevItem(l);o&&o.focus(),e.preventDefault();break;case 13:this.onOptionSelect(e,t),e.preventDefault()}},findNextItem(e){let l=e.nextElementSibling;return l?t.DomHandler.hasClass(l,"p-disabled")||t.DomHandler.hasClass(l,"p-listbox-item-group")?this.findNextItem(l):l:null},findPrevItem(e){let l=e.previousElementSibling;return l?t.DomHandler.hasClass(l,"p-disabled")||t.DomHandler.hasClass(l,"p-listbox-item-group")?this.findPrevItem(l):l:null},onFilterChange(e){this.$emit("filter",{originalEvent:e,value:e.target.value})},virtualScrollerRef(e){this.virtualScroller=e}},computed:{visibleOptions(){if(this.filterValue){if(this.optionGroupLabel){let e=[];for(let t of this.options){let i=l.FilterService.filter(this.getOptionGroupChildren(t),this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);i&&i.length&&e.push({...t,items:i})}return e}return l.FilterService.filter(this.options,this.searchFields,this.filterValue,"contains",this.filterLocale)}return this.options},equalityKey(){return this.optionValue?null:this.dataKey},searchFields(){return this.filterFields||[this.optionLabel]},emptyFilterMessageText(){return this.emptyFilterMessage||this.$primevue.config.locale.emptyFilterMessage},emptyMessageText(){return this.emptyMessage||this.$primevue.config.locale.emptyMessage},virtualScrollerDisabled(){return!this.virtualScrollerOptions}},directives:{ripple:i},components:{VirtualScroller:o}};const r={class:"p-listbox p-component"},a={key:0,class:"p-listbox-header"},p={class:"p-listbox-filter-container"},d=["placeholder"],u=n.createElementVNode("span",{class:"p-listbox-filter-icon pi pi-search"},null,-1),c=["tabindex","onClick","onKeydown","aria-label","aria-selected"],h={class:"p-listbox-item-group"},m=["tabindex","onClick","onKeydown","aria-label","aria-selected"],b={key:2,class:"p-listbox-empty-message"},g={key:3,class:"p-listbox-empty-message"};!function(e,t){void 0===t&&(t={});var l=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===l&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}("\n.p-listbox-list-wrapper {\n    overflow: auto;\n}\n.p-listbox-list {\n    list-style-type: none;\n    margin: 0;\n    padding: 0;\n}\n.p-listbox-item {\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n.p-listbox-item-group {\n    cursor: auto;\n}\n.p-listbox-filter-container {\n    position: relative;\n}\n.p-listbox-filter-icon {\n    position: absolute;\n    top: 50%;\n    margin-top: -.5rem;\n}\n.p-listbox-filter {\n    width: 100%;\n}\n"),s.render=function(e,t,l,i,o,s){const y=n.resolveComponent("VirtualScroller"),f=n.resolveDirective("ripple");return n.openBlock(),n.createElementBlock("div",r,[n.renderSlot(e.$slots,"header",{value:l.modelValue,options:s.visibleOptions}),l.filter?(n.openBlock(),n.createElementBlock("div",a,[n.createElementVNode("div",p,[n.withDirectives(n.createElementVNode("input",{type:"text",class:"p-listbox-filter p-inputtext p-component","onUpdate:modelValue":t[0]||(t[0]=e=>o.filterValue=e),placeholder:l.filterPlaceholder,onInput:t[1]||(t[1]=(...e)=>s.onFilterChange&&s.onFilterChange(...e))},null,40,d),[[n.vModelText,o.filterValue]]),u])])):n.createCommentVNode("",!0),n.createElementVNode("div",{class:"p-listbox-list-wrapper",style:n.normalizeStyle(l.listStyle)},[n.createVNode(y,n.mergeProps({ref:s.virtualScrollerRef},l.virtualScrollerOptions,{style:l.listStyle,items:s.visibleOptions,disabled:s.virtualScrollerDisabled}),n.createSlots({content:n.withCtx((({styleClass:i,contentRef:r,items:a,getItemOptions:p,contentStyle:d})=>[n.createElementVNode("ul",{ref:r,class:n.normalizeClass(["p-listbox-list",i]),style:n.normalizeStyle(d),role:"listbox","aria-multiselectable":"multiple"},[l.optionGroupLabel?(n.openBlock(!0),n.createElementBlock(n.Fragment,{key:1},n.renderList(a,((l,i)=>(n.openBlock(),n.createElementBlock(n.Fragment,{key:s.getOptionGroupRenderKey(l)},[n.createElementVNode("li",h,[n.renderSlot(e.$slots,"optiongroup",{option:l,index:s.getOptionIndex(i,p)},(()=>[n.createTextVNode(n.toDisplayString(s.getOptionGroupLabel(l)),1)]))]),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(s.getOptionGroupChildren(l),((l,i)=>n.withDirectives((n.openBlock(),n.createElementBlock("li",{tabindex:s.isOptionDisabled(l)?null:"0",class:n.normalizeClass(["p-listbox-item",{"p-highlight":s.isSelected(l),"p-disabled":s.isOptionDisabled(l)}]),key:s.getOptionRenderKey(l),onClick:e=>s.onOptionSelect(e,l),onTouchend:t[3]||(t[3]=e=>s.onOptionTouchEnd()),onKeydown:e=>s.onOptionKeyDown(e,l),role:"option","aria-label":s.getOptionLabel(l),"aria-selected":s.isSelected(l)},[n.renderSlot(e.$slots,"option",{option:l,index:s.getOptionIndex(i,p)},(()=>[n.createTextVNode(n.toDisplayString(s.getOptionLabel(l)),1)]))],42,m)),[[f]]))),128))],64)))),128)):(n.openBlock(!0),n.createElementBlock(n.Fragment,{key:0},n.renderList(a,((l,i)=>n.withDirectives((n.openBlock(),n.createElementBlock("li",{tabindex:s.isOptionDisabled(l)?null:"0",class:n.normalizeClass(["p-listbox-item",{"p-highlight":s.isSelected(l),"p-disabled":s.isOptionDisabled(l)}]),key:s.getOptionRenderKey(l),onClick:e=>s.onOptionSelect(e,l),onTouchend:t[2]||(t[2]=e=>s.onOptionTouchEnd()),onKeydown:e=>s.onOptionKeyDown(e,l),role:"option","aria-label":s.getOptionLabel(l),"aria-selected":s.isSelected(l)},[n.renderSlot(e.$slots,"option",{option:l,index:s.getOptionIndex(i,p)},(()=>[n.createTextVNode(n.toDisplayString(s.getOptionLabel(l)),1)]))],42,c)),[[f]]))),128)),o.filterValue&&(!a||a&&0===a.length)?(n.openBlock(),n.createElementBlock("li",b,[n.renderSlot(e.$slots,"emptyfilter",{},(()=>[n.createTextVNode(n.toDisplayString(s.emptyFilterMessageText),1)]))])):!l.options||l.options&&0===l.options.length?(n.openBlock(),n.createElementBlock("li",g,[n.renderSlot(e.$slots,"empty",{},(()=>[n.createTextVNode(n.toDisplayString(s.emptyMessageText),1)]))])):n.createCommentVNode("",!0)],6)])),_:2},[e.$slots.loader?{name:"loader",fn:n.withCtx((({options:t})=>[n.renderSlot(e.$slots,"loader",{options:t})]))}:void 0]),1040,["style","items","disabled"])],4),n.renderSlot(e.$slots,"footer",{value:l.modelValue,options:s.visibleOptions})])},module.exports=s;
